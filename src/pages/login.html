<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mãos Unidas - Nutrindo a Esperança</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Poppins:wght@700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="../styles/style.css">
</head>
<body>

    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-custom">
            <div class="container">
                <a class="navbar-brand" href="../../index.html" aria-label="Página inicial Mãos Unidas">
                    <img src="../img/logo.png" alt="Logo Mãos Unidas">
                </a>

                <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Abrir menu de navegação">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar">
                    <div class="offcanvas-header">
                        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Fechar"></button>
                    </div>
                    <div class="offcanvas-body">
                        <ul class="navbar-nav ms-auto text-center flex-grow-1">
                            <li class="nav-item"><a class="nav-link" href="../../index.html">Início</a></li>
                            <li class="nav-item"><a class="nav-link" href="dashboard_doador.html">Doadores</a></li>
                            <li class="nav-item"><a class="nav-link" href="dashboard_instituicao.html">Instituição</a></li>
                            <li class="nav-item"><a class="nav-link" href="blog.html">Blog</a></li>
                            <li class="nav-item"><a class="nav-link" href="contato.html">Contato</a></li>
                            <li class="nav-item"><a class="nav-link" href="transparencia.html">Transparência</a></li>
                            <li class="nav-item"><a class="nav-link" href="login.html">Login</a></li>
                            <li class="nav-item"><a class="nav-link" href="register.html">Registro</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container">
        <div class="row d-flex justify-content-center align-items-center vh-100">
            <div class="col-12 col-md-8 col-lg-6 col-xl-5">

                <div class="form-container text-center">
                    <img src="../img/logo2.png" alt="Logotipo Mãos Unidas - Nutrindo a Esperança" class="logo mb-4">

                    <form id="loginForm" novalidate>
                        <div class="form-floating mb-3 text-start">
                            <input type="email" class="form-control" id="email" placeholder="seu@email.com" required>
                            <label for="email">Email</label>
                            <div id="erroEmail" class="erro-msg"></div>
                        </div>

                        <div class="form-floating mb-3 text-start">
                            <input type="password" class="form-control" id="senha" placeholder="Senha" required>
                            <label for="senha">Senha</label>
                            <div id="erroSenha" class="erro-msg"></div>
                        </div>

                        <p class="cadastro-link mb-4">
                            Não está cadastrado ainda? <a href="register.html">clique aqui</a>
                        </p>

                        <button class="btn btn-entrar w-100 py-2 bg-custom text-white" type="submit">Entrar</button>
                    </form>
                </div>

            </div>
        </div>
    </main>

    <footer class="bg-custom text-white py-5">
        <div class="container">
            <div class="row gy-4 align-items-center">
                <div class="col-lg-5 text-center text-lg-start">
                    <a href="../../index.html" class="mb-3 d-inline-block" aria-label="Página inicial Mãos Unidas">
                        <img src="../img/logo.png" alt="Logo Mãos Unidas" class="logo-footer mb-3">
                    </a>
                    <p>Seja você um doador (pessoa física ou empresa) ou uma instituição, o cadastro é simples e leva poucos minutos.</p>
                </div>
                <div class="col-lg-6 text-center text-lg-start ps-lg-5">
                    <h5 class="text-uppercase">Menu</h5>
                    <ul class="list-unstyled">
                        <li><a href="../../index.html">Início</a></li>
                        <li><a href="dashboard_doador.html">Doadores</a></li>
                        <li><a href="dashboard_instituicao.html">Instituição</a></li>
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="contato.html">Contato</a></li>
                        <li><a href="transparencia.html">Transparência</a></li>
                        <li><a href="login.html">Login</a></li>
                        <li><a href="register.html">Registro</a></li>
                    </ul>
                </div>
            </div>
            <hr class="my-4" style="color: rgba(255,255,255,0.2);">
            <div class="text-center">
                <p class="mb-0">&copy; Mãos Unidas 2025. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <script>
        document.getElementById("loginForm").addEventListener("submit", function(event) {
            const email = document.getElementById("email").value.trim();
            const senha = document.getElementById("senha").value.trim();
            const erroEmail = document.getElementById("erroEmail");
            const erroSenha = document.getElementById("erroSenha");
            let valido = true;

            // Limpa mensagens anteriores
            erroEmail.textContent = "";
            erroSenha.textContent = "";

            // Validação do e-mail
            const arrobas = (email.match(/@/g) || []).length;
            if (arrobas !== 1 || email.startsWith("@") || email.endsWith("@")) {
                erroEmail.textContent = "Digite um e-mail válido contendo apenas um '@'.";
                valido = false;
            }

            // Validação da senha
            if (senha.length < 8) {
                erroSenha.textContent = "A senha deve ter no mínimo 8 caracteres.";
                valido = false;
            }

            // Verifica se todos os campos foram preenchidos
            if (email === "" || senha === "") {
                if (email === "") erroEmail.textContent = "O campo de e-mail é obrigatório.";
                if (senha === "") erroSenha.textContent = "O campo de senha é obrigatório.";
                valido = false;
            }

            // Bloqueia envio se inválido
            if (!valido) {
                event.preventDefault();
            } else {
                // Evita envio para fazer a checagem local e exibir os dados em um alert
                event.preventDefault();
                try {
                    // Fonte de registros em memória (não persiste). Aceita transferência via window.name.
                    const examples = [
                        { nome: 'João Silva', genero: 'masculino', email: 'joao.silva@example.com', documentoTipo: 'cpf', cpf: '123.456.789-09', telefone: '(11) 98888-7777', rg: '12.345.678-9', endereco: 'Av. Paulista, 1000', bairro: 'Bela Vista', cidade: 'São Paulo', estado: 'SP', cep: '01310-100', data_nascimento: '1990-05-10', tipo: 'doador', escolaridade: 'ensino_superior_completo', criadoEm: new Date().toISOString(), senha: 'senha123' }
                    ];
                    let regs = examples.slice();
                    try {
                        if (window.name) {
                            const transferred = JSON.parse(window.name);
                            if (transferred && typeof transferred === 'object' && !Array.isArray(transferred)) regs.unshift(transferred);
                            window.name = '';
                        }
                    } catch(e){ window.name = ''; }
                    const user = regs.find(r => r.email && r.email.toLowerCase() === email.toLowerCase() && r.senha === senha);
                    if (user) {
                        const details = [
                            `Usuário encontrado:`,
                            `Nome: ${user.nome || '—'}`,
                            `Email: ${user.email || '—'}`,
                            `Tipo: ${user.tipo || '—'}`,
                            `Telefone: ${user.telefone || '—'}`,
                            `Cidade: ${user.cidade || '—'}`,
                            `Documento: ${user.documento || '—'}`,
                            `Cadastrado em: ${user.criadoEm ? new Date(user.criadoEm).toLocaleString() : '—'}`
                        ].join('\n');
                        alert(details);
                    } else {
                        alert('Email ou senha incorretos ou usuário não cadastrado.');
                    }
                } catch (err) {
                    console.error('Erro ao acessar registros:', err);
                    alert('Ocorreu um erro ao verificar o cadastro.');
                }
            }
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
